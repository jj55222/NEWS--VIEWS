# FOIA-Free Content Pipeline — Policy Configuration
# Adjust these settings without code changes.

# ─── Triage thresholds (tunable — adjust to move PASS volume) ───
triage:
  # Score thresholds
  pass_score: 70             # minimum model_score for PASS
  pass_anchors: 2            # minimum completeness anchors for PASS
  pass_strong_anchors: 3     # anchor count that relaxes score requirement
  pass_strong_score: 60      # lower score threshold when anchors >= pass_strong_anchors
  maybe_score: 55            # minimum model_score for MAYBE
  maybe_anchors: 1           # minimum anchors for MAYBE
  # Legacy aliases (used if new keys not set)
  pass_threshold: 70
  maybe_threshold: 55
  # Minimum video duration (seconds) to consider as longform candidate
  min_duration_sec: 60
  # Maximum candidates to process per triage run
  batch_size: 200

# ─── Score dimensions (must sum to 100) ───
score_weights:
  hook_clarity: 25
  escalation: 25
  character: 15
  resolution: 15
  quality: 10
  uniqueness: 10

# ─── Sensitive case routing (NOT auto-kill) ───
# Sensitive categories are routed with flags, not blocked.
# See triage_llm.py for sensitivity_review / sensitivity_type handling.
sensitivity_routing:
  enabled: true
  types:
    - minors
    - CSA
    - trafficking
    - sexual_violence
    - graphic_violence

# ─── Redaction / blur rules ───
redaction:
  blur_non_officers: true
  blur_minors: true
  blur_house_numbers: true
  blur_license_plates: true
  blur_tattoos_if_sensitive: true
  bleep_addresses: true
  bleep_phone_numbers: true
  bleep_ssns: true
  bleep_medical_info: true

# ─── Tone / ethics guardrails ───
ethics:
  no_humiliation_edits: true
  no_guilty_language_pre_conviction: true
  avoid_gotcha_mental_health: true
  # Default presumption language
  presumption_label: "alleged"

# ─── Source tiers ───
source_tiers:
  tier_a:
    - official_law_enforcement_channel
    - official_city_county_state_channel
    - critical_incident_briefing
    - court_livestream_archive
    - da_ag_press_release
  tier_b:
    - local_newsroom_youtube    # discovery only, not main reupload
    - public_scanner_archive    # discovery only

  disallowed:
    - foia_request_portal
    - leaked_private_footage
    - unclear_license_reupload

# ─── Rendering defaults ───
render:
  longform_min_sec: 480     # 8 minutes
  longform_max_sec: 1500    # 25 minutes
  short_min_sec: 15
  short_max_sec: 60
  shorts_per_story_min: 3
  shorts_per_story_max: 10
  caption_font: "Arial"
  caption_font_size: 24
  export_resolution: "1920x1080"
  export_fps: 30
  export_codec: "libx264"
  export_audio_codec: "aac"

# ─── Automation schedule ───
schedule:
  ingest_interval_hours: 6
  triage_after_ingest: true
  corroborate_package_schedule: "nightly"
  render_trigger: "on_approve"   # "on_approve" or "nightly_batch"

# ─── LLM configuration ───
llm:
  # Model for triage scoring
  triage_model: "openai/gpt-4o"
  # Model for narration drafting
  narration_model: "openai/gpt-4o"
  # Model for corroboration
  corroboration_model: "openai/gpt-4o-mini"
  # Temperature for triage (lower = more consistent)
  triage_temperature: 0.2
  # Temperature for narration (slightly higher for creativity)
  narration_temperature: 0.5
  # Max tokens for triage response
  triage_max_tokens: 1500
  # Max tokens for narration
  narration_max_tokens: 4000

# ─── Forwarding: PASS + MAYBE → case_leads for artifact hunt ───
# "No more lost alpha" — every MAYBE is forwarded alongside PASS.
forwarding:
  # Master toggle: forward MAYBEs to artifact hunt (set false to revert)
  route_maybes_to_artifact_hunt: true
  # Minimum triage_score for a MAYBE to be forwarded (0 = forward all)
  maybe_score_min_to_forward: 0

# ─── v2: Artifact hunting config (routing, not gating) ───
# PASS is no longer blocked by missing artifacts — triage sets
# needs_artifact_hunt=true and downstream hunts for them.
artifact_hunting:
  # Minimum confidence for an artifact to count as "found"
  artifact_min_confidence: 0.7
  # Hook score threshold for leads to enter artifact hunt
  hunt_hook_threshold: 70
  # Max search queries per lead during artifact hunt
  hunt_max_queries: 8
  # Max URLs to fetch per lead during artifact hunt
  hunt_max_urls: 25

# ─── Logging ───
logging:
  level: "INFO"
  log_dir: "data/logs"
  rotate_days: 30
